#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.18444
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Somedave.Views.Blog.Posts
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    using FluentBootstrap;
    using Somedave;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/Blog/Posts/right-click-context-menus-in-gtksharp.cshtml")]
    public partial class right_click_context_menus_in_gtksharp : Somedave.BlogPostViewPage<dynamic>
    {
        public right_click_context_menus_in_gtksharp()
        {
        }
        public override void Execute()
        {
            
            #line 1 "..\..\Views\Blog\Posts\right-click-context-menus-in-gtksharp.cshtml"
  
    Title = "Right-Click Context Menus In GtkSharp";
    Published = new DateTime(2010, 4, 12);
    Tags = new[] { "Mono", "GtkSharp", "ButtonPressEvent", "Context Menu", "ContextMenuHelper", "Menu", "Popup", "Popup Menu" };

            
            #line default
            #line hidden
WriteLiteral(@"

<p>To show a context menu in GtkSharp (or ""popup"" as they're called in Gtk land), you would normally add an event handler for Widget.PopupMenu, create or use a Menu instance, and then call Menu.Popup. The only problem is that for many widgets, the right-click doesn't trigger the Widget.PopupMenu event. This is fine for systems where there is no right mouse button or where a right-click isn't the customary way of initiating context menus. However, on systems where there is a user expectation that the way to open a context menu is through a right-click (such as Windows), we need some way to trigger one.</p>
<p>The situation is complicated a little bit by the existing behavior of Widget.PopupMenu. According to the <a");

WriteLiteral(" href=\"http://library.gnome.org/devel/gtk/unstable/gtk-migrating-checklist.html#c" +
"hecklist-popup-menu\"");

WriteLiteral(@">Gtk manual</a>, ""By default, the key binding mechanism is set to emit this signal when the Shift+F10 or Menu keys are pressed while a widget has the focus."" There is a recommendation in the manual that if a developer wants context menus on right-click they should handle the Widget.ButtonPressEvent, listen for the appropriate clicks, and launch the menu using the Menu.Popup method. This is all fine except that now you've got two things to listen to to get proper context menu handling: Widget.PopupMenu and Widget.ButtonPressEvent. It would be nice if there were just one event to handle that got raised anytime a context menu needed to be displayed.</p>
<p>The following class does just that. You can ""attach"" it to any Widget and it will listen for the Widget.PopupMenu event to work with the default context menu handling and the Widget.ButtonPressEvent to also work with right-clicks. When either of these occur, it will first propagate the event through to the underlying Widget (in case there are other things that are supposed to be triggered by whatever event caused the context menu) and then raise a ContextMenuHelper.ContextMenu event that you can handle and use to display the context menu regardless of what triggered it. This method should ensure proper event handling and ordering while reducing duplication of code by enabling a single event for context menu handling.</p>

<pre><code");

WriteLiteral(" class=\"language-csharp\"");

WriteLiteral(">using System;\r\nusing Gdk;\r\nusing GLib;\r\nusing Gtk;\r\n\r\nnamespace Somedave\r\n{\r\n pu" +
"blic class ContextMenuEventArgs : EventArgs\r\n {\r\n  private Widget widget;\r\n  pub" +
"lic Widget Widget { get { return widget; } }\r\n\r\n  private bool rightClick;\r\n  pu" +
"blic bool RightClick { get { return rightClick; } }\r\n\r\n  public ContextMenuEvent" +
"Args(Widget widget, bool rightClick)\r\n  {\r\n   this.widget = widget;\r\n   this.rig" +
"htClick = rightClick;\r\n  }\r\n }\r\n\r\n public class ContextMenuHelper\r\n {\r\n  public " +
"event EventHandler&lt;ContextMenuEventArgs&gt; ContextMenu;\r\n\r\n  public ContextM" +
"enuHelper()\r\n  {}\r\n\r\n  public ContextMenuHelper(Widget widget)\r\n  {\r\n   AttachTo" +
"Widget(widget);\r\n  }\r\n\r\n  public ContextMenuHelper(Widget widget, EventHandler h" +
"andler)\r\n  {\r\n   AttachToWidget(widget);\r\n   ContextMenu += handler;\r\n  }\r\n\r\n  p" +
"ublic void AttachToWidget(Widget widget)\r\n  {\r\n   widget.PopupMenu += Widget_Pop" +
"upMenu;\r\n   widget.ButtonPressEvent += Widget_ButtonPressEvent;\r\n  }\r\n\r\n  public" +
" void DetachFromWidget(Widget widget)\r\n  {\r\n   widget.PopupMenu -= Widget_PopupM" +
"enu;\r\n   widget.ButtonPressEvent -= Widget_ButtonPressEvent;\r\n  }\r\n\r\n  [GLib.Con" +
"nectBefore]\r\n  private void Widget_PopupMenu(object o, PopupMenuArgs args)\r\n  {\r" +
"\n   RaiseContextMenuEvent(args, (Widget)o, false);\r\n  }\r\n\r\n  [GLib.ConnectBefore" +
"]\r\n  private void Widget_ButtonPressEvent(object o, ButtonPressEventArgs args)\r\n" +
"  {\r\n   if (args.Event.Button == 3 &amp;&amp; args.Event.Type == EventType.Butto" +
"nPress)\r\n   {\r\n    RaiseContextMenuEvent(args, (Widget)o, true);\r\n   }\r\n  }\r\n\r\n " +
" private bool propagating = false;   //Prevent reentry\r\n\r\n  private void RaiseCo" +
"ntextMenuEvent(SignalArgs signalArgs, Widget widget, bool rightClick)\r\n  {\r\n   i" +
"f (!propagating)\r\n   {\r\n    //Propagate the event\r\n    Event evnt = Gtk.Global.C" +
"urrentEvent;\r\n    propagating = true;\r\n    Gtk.Global.PropagateEvent(widget, evn" +
"t);\r\n    propagating = false;\r\n    signalArgs.RetVal = true;     //The widget al" +
"ready processed the event in the propagation\r\n\r\n    //Raise the context menu eve" +
"nt\r\n    ContextMenuEventArgs args = new ContextMenuEventArgs(widget, rightClick)" +
";\r\n    if (ContextMenu != null)\r\n    {\r\n     ContextMenu.Invoke(this, args);\r\n  " +
"  }\r\n   }\r\n  }\r\n }\r\n}\r\n</code></pre>");

        }
    }
}
#pragma warning restore 1591
